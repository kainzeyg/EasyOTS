# EasyOTS

### 1. `POST /api/create`  
**Назначение**: Создание нового секретного сообщения  
**Параметры**:
- `secret` (обязательный) - текст сообщения для шифрования
- `ttl` (опциональный) - время жизни в секундах (по умолчанию 604800 - 7 дней)

**Что делает**:
1. Генерирует 2 UUID:  
   - `secretID` - для хранения в Redis  
   - `pageID` - для публичной ссылки  
2. Шифрует сообщение (AES-GCM)  
3. Сохраняет в Redis:  
   - `secret:<secretID>` - зашифрованное сообщение  
   - `page:<pageID>` -> `secretID` (связь)  
4. Возвращает JSON с ссылкой вида `http://localhost:8080/page/<pageID>`

**Пример ответа**:
```json
{
  "status": "success",
  "link": "http://localhost:8080/page/7FA7C1E5-D9B5-44B0-8556-5AA5B0701E4F",
  "page_id": "7FA7C1E5-D9B5-44B0-8556-5AA5B0701E4F"
}
```

---

### 2. `GET /api/view/:id`  
**Назначение**: Получение расшифрованного сообщения  
**Параметры**:
- `id` (в URL) - идентификатор страницы (`pageID`)

**Что делает**:
1. По `pageID` находит `secretID` в Redis  
2. Извлекает зашифрованное сообщение  
3. Расшифровывает его  
4. Удаляет данные из Redis (одноразовость)  
5. Возвращает расшифрованный текст  

**Пример ответа**:
```json
{
  "secret": "Мой секретный текст"
}
```

---

### 3. `GET /page`  
**Назначение**: Главная страница с формой создания  
**Что делает**:
- Отображает HTML-страницу с:  
  - Поле ввода сообщения  
  - Поле ввода срока хранения (в днях)  
  - Кнопка "Создать секрет"

---

### 4. `GET /page/:id`  
**Назначение**: Страница просмотра секрета  
**Параметры**:
- `id` (в URL) - идентификатор страницы (`pageID`)

**Что делает**:
1. Проверяет существование секрета  
2. Отображает:  
   - Кнопку "Просмотреть секрет" (если секрет существует)  
   - Форму создания (если секрет не найден или просмотрен)  
3. После нажатия кнопки вызывает `/api/view/:id` через AJAX

---

### Особенности работы:
1. **Одноразовость**: Секрет удаляется после первого просмотра  
2. **TTL**: Автоматическое удаление по истечении срока  
3. **Шифрование**: AES-256 с ключом `32-byte-long-key-...`  
4. **Разделение ID**:  
   - `secretID` - только для Redis  
   - `pageID` - для публичных ссылок  

Все эндпоинты возвращают:
- HTTP 200 при успехе  
- HTTP 400 при неверных параметрах  
- HTTP 404 если секрет не найден  
- HTTP 500 при внутренних ошибках  

Для тестирования можно использовать cURL:
```bash
# Создание
curl -X POST http://localhost:8080/api/create -d "secret=MySecret&ttl=3600"

# Просмотр
curl http://localhost:8080/api/view/7FA7C1E5-D9B5-44B0-8556-5AA5B0701E4F
```

---

### Запуск приложения:
```bash
# 1.Склонировать проект
# 2.Перейти в каталог проекта
cd <project directory>
# 3.Сборка и запуск
sudo docker-compose up -d --build
```
